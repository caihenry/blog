---
title: 个人开发者使用新浪容器云解决小程序域名备案问题
id: p1
date: 2019-03-19 17:36:22
updated: 2019-03-19 17:36:22
categories: 
- 小程序
tags: 
- 部署
- 代理
- 新浪云
- 小程序
- nginx
keywords:
description: 目前微信官方要求小程序必须使用已备案的https域名。对于个人开发者，在开发初期为了节省成本，可以通过使用新浪容器云的二级域名做https代理，暂时解决小程序域名备案问题。
permalink:
---

# 注册新浪云

[注册地址](https://www.sinacloud.com/public/login/inviter/gaimrn-mddmzeKWrhKWnZYGIeWd-no1of3y6dg.html)

# 创建容器云

* 登陆新浪云“**用户中心**”
* 鼠标移至左上角的“**控制台**”，选择“**云应用SAE**”
* 点击左上角的“**创建应用**”
* 在弹出“**创建应用前须知**”对话框，点击“**我已确认**”
* “**开发语言**”项选择“**容器虚拟机**”
* “**操作系统**”选择ubuntu
* “**操作系统**”版本选择**18.04**
* “**单实例配置**”选择“**基础型**”
* “**二级域名**”输入 miniapp
* “**应用名称**”输入 miniapp
* 点击右侧“确认创建”按钮

# 部署步骤

* 登陆容器云
* 执行下面命令

``` bash

# apt update
# apt upgrade -y
# apt install -y nginx
# apt install -y vim
# apt install -y tzdata
# tzselect
# vim .bashrc
# source .bashrc
# rm -vf /etc/nginx/sites-enabled/default
# rm -vf /etc/nginx/sites-available/default
# vim /etc/nginx/sites-available/proxy

server {
        listen   5050; 
        listen   [::]:5050 default ipv6only=on;

        client_header_buffer_size 4m;
        root /usr/share/nginx/html;
        index index.html index.htm;

        location /index.html {
                expires 0;
                rewrite ^ /index.html break;
        }

        location / {
                proxy_pass         https://<your domain>/;
                proxy_redirect     off;

                proxy_set_header   Host             $http_host;
                proxy_set_header   X-Real-IP        $remote_addr;
                proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        }
}


# ln -s /etc/nginx/sites-available/proxy /etc/nginx/sites-enabled/proxy
# service nginx restart

```

# 注意事项

* nginx端口必须配置新浪云要求的**5050**
* 新浪云重启会重置环境（尽量不要重启）